#!/usr/bin/env bash

if [[ $# -lt 2 ]]; then
  echo "Use backup [-i] <directory> <target 1> <target 2> ... <target n>"
  echo "Where target is: b2, gdrive."
  exit 2
fi

declare -A matrix
matrix["documents","b2"]="b2-crypt"
matrix["documents","gdrive"]="gdrive"
matrix["photos","b2"]="b2-crypt"
matrix["photos","gdrive"]="gdrive"
matrix["backups","b2"]="b2-crypt"
matrix["backups","gdrive"]="gdrive-crypt"
matrix["archive","b2"]="b2-crypt"
matrix["archive","gdrive"]="gdrive-crypt"
matrix["videos","b2"]="b2-crypt"
matrix["videos","gdrive"]="gdrive-crypt"

directory=$1

for target in "${@:2}"; do
  rclone sync --fast-list --progress --syslog --log-level INFO /home/arg/$directory ${matrix[$directory,$target]}:$directory
done
